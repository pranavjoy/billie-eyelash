<html>
<head>
    <style>

        html {
            height: 100%;
            color: white;
        }


        canvas {
            width : 100%;
            height : 100%;
        }

        #sources {
            display: none;
        }

    </style>
</head>

<body>
<div id="wrap">
    <canvas id="output"></canvas>
</div>

<div id="sources">
    <img id="base" crossorigin="anonymous" src="overlay.jpg" />
    <img id="xtra" crossorigin="anonymous" src="base.jpg" />
    <img id="circle" crossorigin="anonymous" src="black_circle.png"/>

</div>
</body>
<script>
    let visibility = 0;
    const canvas = document.querySelector("canvas");
    const context = canvas.getContext("2d");
    sources = document.getElementById('sources'),
        imgBase = document.getElementById('base'),
        imgXtra = document.getElementById('xtra');
        circle = document.getElementById('circle');

    mySound = new sound("sound.mp3");
    flashlight = new sound("flashlight.mp3")

    function sound(src) {
        this.sound = document.createElement("audio");
        this.sound.src = src;
        this.sound.setAttribute("preload", "auto");
        this.sound.setAttribute("controls", "none");
        this.sound.style.display = "none";
        document.body.appendChild(this.sound);
        this.play = function(){
            this.sound.play();
        }
        this.stop = function(){
            this.sound.pause();
            this.sound.load();

        }
    }

    const mousePosition = {
        x : 0,
        y : 0
    }

    const easeFactor = 0.25;

    function resize(){
        canvas.width= window.innerWidth;
        canvas.height = window.innerHeight;
    }

    function draw() {
        resize();
        context.drawImage(imgBase, 0, 0);
        context.save();

        context.beginPath();
        const position = mousePosition;
        if (visibility % 2 === 0) {
            console.log("It's alive")
    } else {

        context.arc(position.x, position.y, 100, 0, 2 * Math.PI);
        context.clip();
        context.drawImage(imgXtra, 0, 0);
        context.restore();
    }

        window.requestAnimationFrame(draw);

        if (mousePosition.x > 1350 && mousePosition.y < 1550 && mousePosition.y > 250 && mousePosition.y < 500) {
            mySound.play();
        } else {
            mySound.stop();
        }


    }

    function onMouseMove(event){
        mousePosition.x = event.clientX;
        mousePosition.y = event.clientY;
        //console.log(mousePosition)
    }

    function onclick(){
        flashlight.play();
        visibility += 1;
    }

    window.addEventListener("mousemove", onMouseMove);
    window.addEventListener("click", onclick);
    window.requestAnimationFrame(draw);

</script>
</html>